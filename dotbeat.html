<!DOCTYPE html>
<html>
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dotbeat</title>
    <style>
      * {
        margin:0;
        padding: 0;
      }
      body {
        overflow: hidden;
      }
      #canvas {
        width: 100%;
        position: absolute;
        left: 50vw;
        top: 50vh;
        transform: translate(-50%, -50%);
      }
      #link {
        position: absolute;
        right: 20px;
        top: 20px;
        z-index: 1;
        opacity: 0;
        transition: opacity .25s ease-in-out;
      }
    </style>
  </head>
  <body onresize="resize()">
    <canvas id="canvas"></canvas>
    <script>
      var c = document.getElementById('canvas');
      var ctx = c.getContext('2d');
      var dt;
      var sides;

      setup();
      resize();

      setInterval(setup,1000);

      function setup() {
        dt = new Date();
        if(sides >= 1000) {
          sides = 0;
        };
        sides = internetTime();
        ctx.clearRect(0, 0, c.width, c.height);
        draw();
      };

      function resize() {
        ctx.canvas.width = window.innerWidth * 2;
        ctx.canvas.height = window.innerHeight * 2;
        draw();
      };

      function internetTime() {
        return Math.floor((((dt.getUTCHours() + 1) % 24) + dt.getUTCMinutes() / 60 + dt.getUTCSeconds() / 3600) * 1000 / 24);
      };

      function draw() {
        if (c.height >= c.width) {
          var size = c.width/3;
        } else {
          var size = c.height/3;
        };
        var Xcenter = c.width/2;
        var Ycenter = c.height/2;

        ctx.beginPath();
        ctx.moveTo (Xcenter +  size * Math.cos(0), Ycenter + size *  Math.sin(0));
        for (var i = 1; i <= sides;i += 1) {
          ctx.lineTo(Xcenter + size * Math.cos(i * 2 * Math.PI / sides), Ycenter + size * Math.sin(i * 2 * Math.PI / sides));
        };

        var h = dt.getHours();
        var m = dt.getMinutes();
        if (h <= 11 && m <= 59) {
          function backgroundRGB() {
            return Math.floor(((255 / 100) * ((((h * 60) + m) / 1440) * 100)) * 2);
          }
        } else if (h >= 12 && m <= 59) {
          function backgroundRGB() {
            return Math.floor(255 - ((255 / 100) * ((((h * 30) + (m / 2)) / 720) * 100)));
          }
        };

        var strokeRGB;
        if (backgroundRGB() > 80 && backgroundRGB() <= 135) {
          strokeRGB = backgroundRGB() - 100;
        } else if (backgroundRGB() > 135 && backgroundRGB() < 175) {
          strokeRGB = backgroundRGB() + 100;
        } else {
          strokeRGB = backgroundRGB();
        };

        ctx.strokeStyle = 'rgb(' + Math.floor(255 - strokeRGB) + ', ' + Math.floor(255 - strokeRGB) + ', ' + Math.floor(255 - strokeRGB) + ')';
        ctx.lineWidth = 2;
        ctx.stroke();

        document.getElementById('canvas').style.backgroundColor = 'rgb(' + backgroundRGB() + ', ' + backgroundRGB() + ', ' + backgroundRGB() + ')';
        document.body.style.backgroundColor = 'rgb(' + backgroundRGB() + ', ' + backgroundRGB() + ', ' + backgroundRGB() + ')';
      };
    </script>
  </body>
</html>
